@model Quanlinhahang_Admin.Models.MonAn

@{
    ViewData["Title"] = "Thêm món ăn";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<div class="container my-4">
    <a asp-area="Admin" asp-controller="MonAns" asp-action="Index" class="btn btn-success mb-3">
        <i class="fa fa-arrow-left"></i> Quay lại
    </a>

    <div class="mx-auto bg-white p-5 rounded shadow" style="max-width:900px;">
        <h2 class="text-center mb-4 fw-bold">Thêm món ăn mới</h2>

        <form id="createForm" asp-action="Create" enctype="multipart/form-data">
            <div class="mb-3">
                <label class="form-label">Tên món</label>
                <input asp-for="TenMon" class="form-control" required />
            </div>

            <div class="mb-3">
                <label class="form-label">Danh mục</label>
                <select asp-for="DanhMucID" class="form-select" asp-items="ViewBag.DanhMucID">
                    <option value="">-- Chọn danh mục --</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Đơn giá</label>
                <input asp-for="DonGia" class="form-control" type="number" required />
            </div>

            <div class="mb-3">
                <label class="form-label">Trạng thái</label>
                <select asp-for="TrangThai" class="form-select" asp-items="ViewBag.TrangThaiList"></select>
            </div>

            <div class="mb-3">
                <label class="form-label">Hình ảnh món ăn</label>
                <input type="file" id="HinhAnh" name="HinhAnh" class="form-control" accept="image/*" onchange="previewImage(event)" />
                <div id="imagePreview" class="text-center mt-2"></div>
            </div>

            <div class="mb-3">
                <label class="form-label">Mô tả</label>
                <textarea asp-for="MoTa" class="form-control" rows="3"></textarea>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary px-4">Lưu</button>
            </div>
        </form>
    </div>
</div>

<script>
    function previewImage(e) {
        const file = e.target.files[0];
        const preview = document.getElementById('imagePreview');
        preview.innerHTML = '';
        if (file) {
            const reader = new FileReader();
            reader.onload = function(ev) {
                const img = document.createElement('img');
                img.src = ev.target.result;
                img.style.maxWidth = '250px';
                img.style.borderRadius = '10px';
                preview.appendChild(img);
            };
            reader.readAsDataURL(file);
        }
    }

    document.getElementById('createForm').addEventListener('submit', function (e) {
        e.preventDefault();
        Swal.fire({
            title: "Xác nhận thêm món ăn?",
            icon: "question",
            showCancelButton: true,
            confirmButtonText: "Thêm",
            cancelButtonText: "Hủy"
        }).then((result) => {
            if (result.isConfirmed) {
                e.target.submit();
            }
        });
    });
</script>
